<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>（零）ES6模块化与异步编程高级用法 | Ramsayi</title><meta name="keywords" content="Vue3"><meta name="author" content="Ramsayi"><meta name="copyright" content="Ramsayi"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="（零）ES6模块化与异步编程高级用法"><meta name="application-name" content="（零）ES6模块化与异步编程高级用法"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="（零）ES6模块化与异步编程高级用法"><meta property="og:url" content="https://ramsayi.asia/posts/6d870065/index.html"><meta property="og:site_name" content="Ramsayi"><meta property="og:description" content="ES6 模块化1. 回顾：node.js 中如何实现模块化node.js 遵循了 CommonJS 的模块化规范。其中：  导入其它模块使用 require() 方法  模块对外共享成员使用 module.exports 对象   模块化的好处： 大家都遵守同样的模块化规范写代码，降低了沟通的成本，"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png"><meta property="article:author" content="Ramsayi"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png"><meta name="description" content="ES6 模块化1. 回顾：node.js 中如何实现模块化node.js 遵循了 CommonJS 的模块化规范。其中：  导入其它模块使用 require() 方法  模块对外共享成员使用 module.exports 对象   模块化的好处： 大家都遵守同样的模块化规范写代码，降低了沟通的成本，"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://ramsayi.asia/posts/6d870065/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: {"enable":true,"title":"与数百名博主无限进步","addFriendPlaceholder":"昵称（请勿包含博客等字样）：\n网站地址（要求博客地址，请勿提交个人主页）：\n头像图片url（请提供尽可能清晰的图片，我会上传到我自己的图床）：\n描述：\n站点截图（可选）：\n"},
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://twikoo-h131i132g-ramsayi.vercel.app/',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":4000,"accessToken":"cb0fb2efb97f23bb1079a6fbcca42a53","mailMd5":"8a66d758d102fb88"},
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: {"apiurl":"https://friends.anheyu.com/"},
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"这篇文章已经有","messageNext":"天了，信息可能已经有所发展，内容仅供参考。"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Ramsayi","link":"链接: ","source":"来源: Ramsayi","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Ramsayi',
  title: '（零）ES6模块化与异步编程高级用法',
  postAI: '',
  pageFillDescription: 'ES6 模块化, 1. 回顾：node.js 中如何实现模块化, 2.前端模块化规范的分类, 3.什么是 ES6 模块化规范, 4.在 node.js 中体验 ES6 模块化, 5.ES6 模块化的基本语法, 5.1 默认导出, 5.1 默认导入, 5.1 默认导出的注意事项, 5.2 按需导出, 5.2 按需导入, 5.2 按需导出与按需导入的注意事项, 5.3 直接导入并执行模块中的代码, Promise, 1. 回调地狱, 1.1 如何解决回调地狱的问题, 1.2 Promise 的基本概念, 2. 基于回调函数按顺序读取文件内容, 3. 基于 then-fs 读取文件内容, 3.1 then-fs 的基本使用, 3.2 .then() 方法的特性, 3.3 基于 Promise 按顺序读取文件的内容, 3.4 通过 .catch 捕获错误, 3.5 Promise.all() 方法, 3.6 Promise.race() 方法, 4. 基于 Promise 封装读文件的方法 方法的封装要求：, 4.1 getFile 方法的基本定义, 4.2 创建具体的异步操作, 4.3 获取 .then 的两个实参, 4.4 调用 resolve 和 reject 回调函数, asyncx2Fawait, 1. 什么是 asyncx2Fawait, 2. asyncx2Fawait 的基本使用, 3. asyncx2Fawait 的使用注意事项, EventLoop, 1. JavaScript 是单线程的语言, 2. 同步任务和异步任务, 3. 同步任务和异步任务的执行过程, 4. EventLoop 的基本概念, 4. 结合 EventLoop 分析输出的顺序, 宏任务和微任务, 1. 什么是宏任务和微任务, 2. 宏任务和微任务的执行顺序, 3. 去银行办业务的场景, 4. 分析以下代码输出的顺序, 5. 经典面试题, API 接口案例, 1. 案例需求, 2. 主要的实现步骤, 3. 搭建项目的基本结构, 4. 创建基本的服务器, 5. 创建 db 数据库操作模块, 6. 创建 user_ctrl 模块, 7. 创建 user_router 模块, 8. 导入并挂载路由模块, 9. 使用 try…catch 捕获异常, 总结模块化回顾中如何实现模块化遵循了的模块化规范其中导入其它模块使用方法模块对外共享成员使用对象模块化的好处大家都遵守同样的模块化规范写代码降低了沟通的成本极大方便了各个模块之间的相互调用利人利己前端模块化规范的分类在模块化规范诞生之前社区已经尝试并提出了等模块化规范但是这些由社区提出的模块化标准还是存在一定的差异性与局限性并不是浏览器与服务器通用的模块化标准例如和适用于浏览器端的模块化适用于服务器端的模块化太多的模块化规范给开发者增加了学习的难度与开发的成本因此大一统的模块化规范诞生了什么是模块化规范模块化规范是浏览器端与服务器端通用的模块化开发规范它的出现极大的降低了前端开发者的模块化学习成本开发者不需再额外学习或等模块化规范模块化规范中定义每个文件都是一个独立的模块导入其它模块成员使用关键字向外共享模块成员使用关键字在中体验模块化中默认仅支持模块化规范若想基于体验与学习的模块化语法可以按照如下两个步骤进行配置确保安装了或更高版本的在的根节点中添加节点模块化的基本语法的模块化主要包含如下种用法默认导出与默认导入按需导出与按需导入直接导入并执行模块中的代码默认导出默认导出的语法默认导出的成员定义模块私有成员定义模块私有成员外界访问不到因为它没有被共享出去定义模块私有方法使用默认导出语法向外共享和两个成员默认导入默认导入的语法接收名称模块标识符从模块中导入向外共享的成员并使用成员进行接收打印输出的结果为默认导出的注意事项每个模块中只允许使用唯一的一次否则会报错定义模块私有成员定义模块私有成员外界访问不到因为它没有被共享出去定义模块私有方法使用默认导出语法向外共享和两个成员默认导入时的接收名称可以任意名称只要是合法的成员名称即可是合法的名称不是合法的名称因为成员名称不能以数字开头按需导出按需导出的语法按需导出的成员当前模块为向外按需导出变量向外按需导出变量向外按需导出方法按需导入按需导入的语法模块标识符导入模块成员打印输出打印输出打印输出按需导出与按需导入的注意事项每个模块中可以使用多次按需导出按需导入的成员名称必须和按需导出的名称保持一致按需导入时可以使用关键字进行重命名按需导入可以和默认导入一起使用直接导入并执行模块中的代码如果只想单纯地执行某个模块中的代码并不需要得到模块中向外共享的成员此时可以直接导入并执行模块代码示例代码如下当前文件模块为在当前模块中执行一个循环操作分割线直接导入并执行模块代码不需要得到模块向外共享的成员回调地狱多层回调函数的相互嵌套就形成了回调地狱示例代码如下第层回调函数延时秒后输出第层回调函数延时秒后输出第层回调函数延时秒后输出回调地狱的缺点代码耦合性太强牵一发而动全身难以维护大量冗余的代码相互嵌套代码的可读性变差如何解决回调地狱的问题为了解决回调地狱的问题中新增了的概念的基本概念是一个构造函数我们可以创建的实例出来的实例对象代表一个异步操作上包含一个方法每一次构造函数得到的实例对象都可以通过原型链的方式访问到方法例如方法用来预先指定成功和失败的回调函数成功的回调函数失败的回调函数调用方法时成功的回调函数是必选的失败的回调函数是可选的基于回调函数按顺序读取文件内容读取文件读取文件失败读取文件成功读取文件读取文件失败读取文件成功读取文件读取文件失败读取文件成功基于读取文件内容由于官方提供的模块仅支持以回调函数的方式读取文件不支持的调用方式因此需要先运行如下的命令安装这个第三方包从而支持我们基于的方式读取文件的内容的基本使用调用提供的方法可以异步地读取文件的内容它的返回值是的实例对象因此可以调用方法为每个异步操作指定成功和失败之后的回调函数示例代码如下注意上述的代码无法保证文件的读取顺序需要做进一步的改进方法的特性如果上一个方法中返回了一个新的实例对象则可以通过下一个继续进行处理通过方法的链式调用就解决了回调地狱的问题基于按顺序读取文件的内容支持链式调用从而来解决回调地狱的问题示例代码如下返回值是的实例对象通过为第一个实例对象指定成功之后的回调函数在第一个中返回一个新的实例对象继续调用为上一个的返回值新的实例指定成功之后的回调函数在第二个中再返回一个新的实例对象继续调用为上一个的返回值新的实例指定成功之后的回调函数通过捕获错误在的链式操作中如果发生了错误可以使用方法进行捕获和处理返回值是的实例对象通过为第一个实例对象指定成功之后的回调函数在第一个中返回一个新的实例对象继续调用为上一个的返回值新的实例指定成功之后的回调函数在第二个中再返回一个新的实例对象继续调用为上一个的返回值新的实例指定成功之后的回调函数捕获第行发生的错误并输出错误的消息如果不希望前面的错误导致后续的无法正常执行则可以将的调用提前示例代码如下返回值是的实例对象捕获第行发生的错误并输出错误的消息由于错误已被及时处理不影响后续的正常执行通过为第一个实例对象指定成功之后的回调函数在第一个中返回一个新的实例对象继续调用为上一个的返回值新的实例指定成功之后的回调函数在第二个中再返回一个新的实例对象继续调用为上一个的返回值新的实例指定成功之后的回调函数方法方法会发起并行的异步操作等所有的异步操作全部结束后才会执行下一步的操作等待机制示例代码如下定义一个数组存放个读文件的异步操作将的数组作为的参数所有文件读取成功等待机制捕获异步操作中的错误注意数组中实例的顺序就是最终结果的顺序方法方法会发起并行的异步操作只要任何一个异步操作完成就立即执行下一步的操作赛跑机制示例代码如下定义一个数组存放个读文件的异步操作将的数组作为的参数只要任何一个异步操作完成就立即执行成功的回调函数赛跑机制捕获异步操作中的错误基于封装读文件的方法方法的封装要求方法的名称要定义为方法接收一个形参表示要读取的文件的路径方法的返回值为实例对象方法的基本定义方法的名称为方法接收一个形参表示要读取的文件的路径方法的返回值为的实例对象注意第行代码中的只是创建了一个形式上的异步操作创建具体的异步操作如果想要创建具体的异步操作则需要在构造函数期间传递一个函数将具体的异步操作定义到函数内部示例代码如下方法的名称为方法接收一个形参表示要读取的文件的路径方法的返回值为的实例对象下面这行代码表示这是一个具体的读文件的异步操作获取的两个实参通过指定的成功和失败的回调函数可以在的形参中进行接收示例代码如下形参是调用方法时通过指定的成功的回调函数形参是调用方法时通过指定的失败的回调函数方法的调用过程成功的回调函数失败的回调函数调用和回调函数异步操作的结果可以调用或回调函数进行处理示例代码如下是成功的回调函数是失败的回调函数如果读取失败则调用失败的回调函数如果读取成功则调用成功的回调函数方法的调用过程成功的回调函数失败的回调函数什么是是引入的新语法用来简化异步操作在出现之前开发者只能通过链式的方式处理异步操作示例代码如下链式调用的优点解决了回调地狱的问题链式调用的缺点代码冗余阅读性差不易理解的基本使用使用简化异步操作的示例代码如下按照顺序读取文件的内容的使用注意事项如果在中使用了则必须被修饰在方法中第一个之前的代码会同步执行之后的代码会异步执行最终输出的顺序是单线程的语言是一门单线程执行的编程语言也就是说同一时间只能做一件事情单线程执行任务队列的问题如果前一个任务非常耗时则后续的任务就不得不一直等待从而导致程序假死的问题同步任务和异步任务为了防止某个耗时任务导致程序假死的问题把待执行的任务分为了两类同步任务又叫做非耗时任务指的是在主线程上排队执行的那些任务只有前一个任务执行完毕才能执行后一个任务异步任务又叫做耗时任务异步任务由委托给宿主环境进行执行当异步任务执行完成后会通知主线程执行异步任务的回调函数同步任务和异步任务的执行过程同步任务由主线程次序执行异步任务委托给宿主环境执行已完成的异步任务对应的回调函数会被加入到任务队列中等待执行主线程的执行栈被清空后会读取任务队列中的回调函数次序执行主线程不断重复上面的第步的基本概念主线程从任务队列中读取异步任务的回调函数放到执行栈中依次执行这个过程是循环不断的所以整个的这种运行机制又称为事件循环结合分析输出的顺序正确的输出结果其中和属于同步任务会根据代码的先后顺序依次被执行和属于异步任务它们的回调函数会被加入到任务队列中等待主线程空闲时再执行宏任务和微任务什么是宏任务和微任务把异步任务又做了进一步的划分异步任务又分为两类分别是宏任务异步请求文件操作其它宏任务微任务和其它微任务宏任务和微任务的执行顺序每一个宏任务执行完之后都会检查是否存在待执行的微任务如果有则执行完所有微任务之后再继续执行下一个宏任务去银行办业务的场景小云和小腾去银行办业务首先需要取号之后进行排队宏任务队列假设当前银行网点只有一个柜员小云在办理存款业务时小腾只能等待单线程宏任务按次序执行小云办完存款业务后柜员询问他是否还想办理其它业务当前宏任务执行完检查是否有微任务小云告诉柜员想要买理财产品再办个信用卡最后再兑换点马年纪念币执行微任务后续宏任务被推迟小云离开柜台后柜员开始为小腾办理业务所有微任务执行完毕开始执行下一个宏任务分析以下代码输出的顺序正确的输出顺序是分析先执行所有的同步任务执行第行第行代码再执行微任务执行第行代码再执行下一个宏任务执行第行代码经典面试题请分析以下代码输出的顺序正确的输出顺序是接口案例案例需求基于数据库对外提供用户列表的接口服务用到的技术点如下第三方包和模块化主要的实现步骤搭建项目的基本结构创建基本的服务器创建数据库操作模块创建业务模块创建路由模块搭建项目的基本结构启用模块化支持在中声明安装第三方依赖包运行创建基本的服务器使用的默认导入语法创建数据库操作模块请填写要操作的数据库的名称请填写登录数据库的用户名请填写登录数据库的密码默认导出一个文件的创建模块获取所有用户的列表数据函数的返回值是的实例对象因此可以使用进行简化获取用户列表数据成功创建模块从模块中按需导入函数创建路由对象挂载路由规则使用的默认导出语法将路由对象共享出去导入并挂载路由模块使用默认导入语法导入路由对象挂载用户路由模块使用捕获异常表中没有字段所以此语句会执行异常获取用户列表数据成功获取用户列表数据失败总结能够知道如何使用的模块化语法默认导出与默认导入按需导出与按需导入能够知道如何使用解决回调地狱问题能够使用简化的调用方法中用到了则方法需要被修饰能够说出什么是示意图能够说出宏任务和微任务的执行顺序在执行下一个宏任务之前先检查是否有待执行的微任务',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-13 20:15:07',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/inject/custom.css"><meta name="generator" content="Hexo 7.0.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://cdn.jsdelivr.net/gh/ramsayi/assets/avatar/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://ramsayi.asia/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://aabbk.github.io" title="网址导航"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="网址导航"/><span class="back-menu-item-text">网址导航</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://scabet.github.io" title="Scabet"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Scabet"/><span class="back-menu-item-text">Scabet</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://aabbt.github.io/" title="Aabbt"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Aabbt"/><span class="back-menu-item-text">Aabbt</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://swclub.github.io/" title="SWClub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="SWClub"/><span class="back-menu-item-text">SWClub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://aabbs.github.io/" title="花里胡哨"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog.anheyu.com/favicon.ico" alt="花里胡哨"/><span class="back-menu-item-text">花里胡哨</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Ramsayi</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/airConditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/technologyStack/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 技术栈</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="随机前往一个开往项目网站"><a class="site-page" onclick="anzhiyu.totraveling()" title="随机前往一个开往项目网站" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/wechat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/wechat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Axios/" style="font-size: 1.05rem;">Axios<sup>1</sup></a><a href="/tags/Bilibili/" style="font-size: 1.05rem;">Bilibili<sup>1</sup></a><a href="/tags/C/" style="font-size: 1.05rem;">C++<sup>35</sup></a><a href="/tags/C-%E7%90%86%E8%AE%BA%E7%BB%BC%E5%90%88%E4%BD%9C%E4%B8%9A/" style="font-size: 1.05rem;">C++理论综合作业<sup>4</sup></a><a href="/tags/Curl/" style="font-size: 1.05rem;">Curl<sup>1</sup></a><a href="/tags/Dart/" style="font-size: 1.05rem;">Dart<sup>114</sup></a><a href="/tags/ECharts/" style="font-size: 1.05rem;">ECharts<sup>4</sup></a><a href="/tags/Excel/" style="font-size: 1.05rem;">Excel<sup>1</sup></a><a href="/tags/FFmpeg/" style="font-size: 1.05rem;">FFmpeg<sup>1</sup></a><a href="/tags/Flutter/" style="font-size: 1.05rem;">Flutter<sup>114</sup></a><a href="/tags/Getx/" style="font-size: 1.05rem;">Getx<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>2</sup></a><a href="/tags/GitKraken/" style="font-size: 1.05rem;">GitKraken<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 1.05rem;">Hexo<sup>3</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem;">JavaScript<sup>7</sup></a><a href="/tags/Jupyter/" style="font-size: 1.05rem;">Jupyter<sup>1</sup></a><a href="/tags/Markdown/" style="font-size: 1.05rem;">Markdown<sup>1</sup></a><a href="/tags/OneDrive/" style="font-size: 1.05rem;">OneDrive<sup>1</sup></a><a href="/tags/Python/" style="font-size: 1.05rem;">Python<sup>10</sup></a><a href="/tags/React/" style="font-size: 1.05rem;">React<sup>9</sup></a><a href="/tags/SARscape/" style="font-size: 1.05rem;">SARscape<sup>1</sup></a><a href="/tags/Sentinel/" style="font-size: 1.05rem;">Sentinel<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 1.05rem;">TypeScript<sup>7</sup></a><a href="/tags/Ubuntu/" style="font-size: 1.05rem;">Ubuntu<sup>2</sup></a><a href="/tags/Unity3D/" style="font-size: 1.05rem;">Unity3D<sup>1</sup></a><a href="/tags/VSCode/" style="font-size: 1.05rem;">VSCode<sup>1</sup></a><a href="/tags/Vim/" style="font-size: 1.05rem;">Vim<sup>1</sup></a><a href="/tags/Vue2/" style="font-size: 1.05rem;">Vue2<sup>2</sup></a><a href="/tags/Vue3/" style="font-size: 1.05rem;">Vue3<sup>10</sup></a><a href="/tags/Windows/" style="font-size: 1.05rem;">Windows<sup>1</sup></a><a href="/tags/You-Get/" style="font-size: 1.05rem;">You-Get<sup>1</sup></a><a href="/tags/uniapp/" style="font-size: 1.05rem;">uniapp<sup>1</sup></a><a href="/tags/%E4%B8%8B%E8%BD%BD/" style="font-size: 1.05rem;">下载<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.05rem;">前端<sup>9</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 1.05rem;">博客<sup>5</sup></a><a href="/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 1.05rem;">快捷键<sup>1</sup></a><a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 1.05rem;">爬虫<sup>1</sup></a><a href="/tags/%E7%BB%88%E7%AB%AF/" style="font-size: 1.05rem;">终端<sup>3</sup></a><a href="/tags/%E8%99%9A%E5%B9%BB5/" style="font-size: 1.05rem;">虚幻5<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91/" style="font-size: 1.05rem;">视频<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">十一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">九月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">十二月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">19</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">113</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" itemprop="url">技术学习</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/Vue/" itemprop="url">Vue</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Vue3/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Vue3</span></a></span></div></div><h1 class="post-title" itemprop="name headline">（零）ES6模块化与异步编程高级用法</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2022-05-08T11:45:48.000Z" title="发表于 2022-05-08 19:45:48">2022-05-08</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-01-13T12:15:07.264Z" title="更新于 2024-01-13 20:15:07">2024-01-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">6.2k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>23分钟</span></span><span class="post-meta-separator"></span><span id="" data-flag-title="（零）ES6模块化与异步编程高级用法"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="twikoo_visitors" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为江苏"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>江苏</span><span class="post-meta-separator"></span><span class="post-meta-commentcount"><i class="anzhiyufont anzhiyu-icon-comments post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/posts/6d870065/#post-comment" tabindex="-1"><span id="twikoo-count"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></a></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://ramsayi.asia/posts/6d870065/"><header><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" itemprop="url">技术学习</a><a class="post-meta-categories" href="/categories/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/Vue/" itemprop="url">Vue</a><a href="/tags/Vue3/" tabindex="-1" itemprop="url">Vue3</a><h1 id="CrawlerTitle" itemprop="name headline">（零）ES6模块化与异步编程高级用法</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Ramsayi</span><time itemprop="dateCreated datePublished" datetime="2022-05-08T11:45:48.000Z" title="发表于 2022-05-08 19:45:48">2022-05-08</time><time itemprop="dateCreated datePublished" datetime="2024-01-13T12:15:07.264Z" title="更新于 2024-01-13 20:15:07">2024-01-13</time></header><h1 id="ES6-模块化"><a href="#ES6-模块化" class="headerlink" title="ES6 模块化"></a>ES6 模块化</h1><h2 id="1-回顾：node-js-中如何实现模块化"><a href="#1-回顾：node-js-中如何实现模块化" class="headerlink" title="1. 回顾：node.js 中如何实现模块化"></a>1. 回顾：node.js 中如何实现模块化</h2><p>node.js 遵循了 CommonJS 的模块化规范。其中：</p>
<ul>
<li><p>导入其它模块使用 require() 方法</p>
</li>
<li><p>模块对外共享成员使用 module.exports 对象</p>
</li>
</ul>
<p>模块化的好处：</p>
<p>大家都遵守同样的模块化规范写代码，降低了沟通的成本，极大方便了各个模块之间的相互调用，利人利己。</p>
<h2 id="2-前端模块化规范的分类"><a href="#2-前端模块化规范的分类" class="headerlink" title="2.前端模块化规范的分类"></a>2.前端模块化规范的分类</h2><p>在 ES6 模块化规范诞生之前，JavaScript 社区已经尝试并提出了 AMD、CMD、Common]S 等模块化规范。<br>但是，这些由社区提出的模块化标准，还是存在一定的差异性与局限性、并不是浏览器与服务器通用的模块化标准，例如:</p>
<ul>
<li>AMD 和 CMD 适用于浏览器端的 Javascript 模块化</li>
<li>CommonJS 适用于服务器端的 Javascript 模块化</li>
</ul>
<p>太多的模块化规范给开发者增加了学习的难度与开发的成本。因此，大一统的 ES6 模块化规范诞生了!</p>
<h2 id="3-什么是-ES6-模块化规范"><a href="#3-什么是-ES6-模块化规范" class="headerlink" title="3.什么是 ES6 模块化规范"></a>3.什么是 ES6 模块化规范</h2><p>ES6 模块化规范是浏览器端与服务器端通用的模块化开发规范。它的出现极大的降低了前端开发者的模块化学习成本，开发者不需再额外学习 AMD、CMD 或 CommonJS 等模块化规范</p>
<p>ES6 模块化规范中定义:</p>
<ul>
<li>每个 js 文件都是一个独立的模块</li>
<li>导入其它模块成员使用 import 关键字</li>
<li>向外共享模块成员使用 export 关键字</li>
</ul>
<h2 id="4-在-node-js-中体验-ES6-模块化"><a href="#4-在-node-js-中体验-ES6-模块化" class="headerlink" title="4.在 node.js 中体验 ES6 模块化"></a>4.在 node.js 中体验 ES6 模块化</h2><p>node.js 中默认仅支持 Common]S 模块化规范，若想基于 node.js 体验与学习 ES6 的模块化语法，可以按照如下两个步骤进行配置:</p>
<ul>
<li>确保安装了 v14.15.1 或更高版本的 node.js</li>
<li>在<code>package.json</code>的根节点中添加<code>&quot;type&quot;: &quot;module&quot;</code>节点</li>
</ul>
<h2 id="5-ES6-模块化的基本语法"><a href="#5-ES6-模块化的基本语法" class="headerlink" title="5.ES6 模块化的基本语法"></a>5.ES6 模块化的基本语法</h2><p>ES6 的模块化主要包含如下 3 种用法:</p>
<p>① 默认导出与默认导入<br>② 按需导出与按需导入<br>③ 直接导入并执行模块中的代码</p>
<h3 id="5-1-默认导出"><a href="#5-1-默认导出" class="headerlink" title="5.1 默认导出"></a>5.1 默认导出</h3><p>默认导出的语法： export default 默认导出的成员</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n1 = <span class="number">10</span> <span class="comment">// 定义模块私有成员 n1</span></span><br><span class="line"><span class="keyword">let</span> n2 = <span class="number">20</span> <span class="comment">// 定义模块私有成员 n2 (外界访问不到 n2,因为它没有被共享出去)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;&#125; <span class="comment">// 定义模块私有方法 show</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// 使用 export default 默认导出语法，向外共享 n1 和 show 两个成员</span></span><br><span class="line">  n1,</span><br><span class="line">  show</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-1-默认导入"><a href="#5-1-默认导入" class="headerlink" title="5.1 默认导入"></a>5.1 默认导入</h3><p>默认导入的语法： import 接收名称 from ‘模块标识符’</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从 01_m1.js 模块中导入 export default 向外共享的成员</span></span><br><span class="line"><span class="comment">// 并使用 m1 成员进行接收</span></span><br><span class="line"><span class="keyword">import</span> m1 <span class="keyword">from</span> <span class="string">&#x27;./01_m1.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 打印输出的结果为：</span></span><br><span class="line"><span class="comment">// &#123; n1: 10, show: [Funtion: show] &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(m1)</span><br></pre></td></tr></table></figure>

<h3 id="5-1-默认导出的注意事项"><a href="#5-1-默认导出的注意事项" class="headerlink" title="5.1 默认导出的注意事项"></a>5.1 默认导出的注意事项</h3><p>每个模块中，只允许使用唯一的一次 export default，否则会报错！</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n1 = <span class="number">10</span> <span class="comment">// 定义模块私有成员 n1</span></span><br><span class="line"><span class="keyword">let</span> n2 = <span class="number">20</span> <span class="comment">// 定义模块私有成员 n2 (外界访问不到 n2,因为它没有被共享出去)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;&#125; <span class="comment">// 定义模块私有方法 show</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="comment">// 使用 export default 默认导出语法，向外共享 n1 和 show 两个成员</span></span><br><span class="line">    n1,</span><br><span class="line">    show</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SyntaxError: Identifier &#x27;.default&#x27; has already been declared</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">	n2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>默认导入时的接收名称可以任意名称，只要是合法的成员名称即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// m1 是合法的名称</span></span><br><span class="line"><span class="keyword">import</span> m1 <span class="keyword">from</span> <span class="string">&#x27;./01_m1.js&#x27;</span></span><br><span class="line"><span class="comment">// 123m不是合法的名称，因为成员名称不能以数字开头</span></span><br><span class="line"><span class="keyword">import</span> 123m <span class="keyword">from</span> <span class="string">&#x27;./01_m1.js&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-按需导出"><a href="#5-2-按需导出" class="headerlink" title="5.2 按需导出"></a>5.2 按需导出</h3><p>按需导出的语法： export 按需导出的成员</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当前模块为03_m2.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//向外按需导出变量s1</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> s1 = <span class="string">&#x27;aaa&#x27;</span></span><br><span class="line"><span class="comment">//向外按需导出变量s2</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> s2 = <span class="string">&#x27;ccc&#x27;</span></span><br><span class="line"><span class="comment">//向外按需导出方法say</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">say</span>(<span class="params"></span>) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-2-按需导入"><a href="#5-2-按需导入" class="headerlink" title="5.2 按需导入"></a>5.2 按需导入</h3><p>按需导入的语法： <code>import &#123; s1 &#125; from &#39;模块标识符&#39;</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入模块成员</span></span><br><span class="line"><span class="keyword">import</span> &#123; s1, s2, say &#125; <span class="keyword">from</span> <span class="string">&#x27;./03_m2.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s1) <span class="comment">// 打印输出 aaa</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s2) <span class="comment">// 打印输出 ccc</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(say) <span class="comment">// 打印输出 [Function: say]</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-按需导出与按需导入的注意事项"><a href="#5-2-按需导出与按需导入的注意事项" class="headerlink" title="5.2 按需导出与按需导入的注意事项"></a>5.2 按需导出与按需导入的注意事项</h3><p>① 每个模块中可以使用<strong>多次</strong>按需导出<br>② 按需<strong>导入的成员名称</strong>必须和<strong>按需导出的名称</strong>保持一致<br>③ 按需导入时，可以使用 <strong>as 关键字</strong>进行重命名<br>④ 按需导入可以和默认导入一起使用</p>
<h3 id="5-3-直接导入并执行模块中的代码"><a href="#5-3-直接导入并执行模块中的代码" class="headerlink" title="5.3 直接导入并执行模块中的代码"></a>5.3 直接导入并执行模块中的代码</h3><p>如果只想单纯地执行某个模块中的代码，并不需要得到模块中向外共享的成员。此时，可以直接导入并执行模块代码，示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 当前文件模块为 05_m3.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 在当前模块中执行一个 for 循环操作</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------------分割线-----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接导入并执行模块代码，不需要得到模块向外共享的成员</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./05_m3.js&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><h2 id="1-回调地狱"><a href="#1-回调地狱" class="headerlink" title="1. 回调地狱"></a>1. 回调地狱</h2><p>多层回调函数的相互嵌套，就形成了回调地狱。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 第 1 层回调函数</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延时 1 秒后输出&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 第 2 层回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延时 2 秒后输出&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 第 3 层回调函数</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延时 3 秒后输出&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">3000</span>)</span><br><span class="line">  &#125;, <span class="number">2000</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure>

<p>回调地狱的缺点：<br>⚫ 代码耦合性太强，牵一发而动全身，难以维护<br>⚫ 大量冗余的代码相互嵌套，代码的可读性变差</p>
<h3 id="1-1-如何解决回调地狱的问题"><a href="#1-1-如何解决回调地狱的问题" class="headerlink" title="1.1 如何解决回调地狱的问题"></a>1.1 如何解决回调地狱的问题</h3><p>为了解决回调地狱的问题，ES6（ECMAScript 2015）中新增了 Promise 的概念。</p>
<h3 id="1-2-Promise-的基本概念"><a href="#1-2-Promise-的基本概念" class="headerlink" title="1.2 Promise 的基本概念"></a>1.2 Promise 的基本概念</h3><p>① Promise 是一个构造函数</p>
<p>⚫ 我们可以创建 Promise 的实例 <strong>const p &#x3D; new Promise()</strong><br>⚫ new 出来的 Promise 实例对象，<strong>代表一个异步操作</strong></p>
<p>② Promise.prototype 上包含一个 .then() 方法</p>
<p>⚫ 每一次 new Promise() 构造函数得到的实例对象，<br>⚫ 都可以通过<strong>原型链的方式</strong>访问到 .then() 方法，例如 <strong>p.then()</strong></p>
<p>③ .then() 方法用来预先指定成功和失败的回调函数</p>
<p>⚫ p.then(<strong>成功的回调函数，失败的回调函数</strong>)<br>⚫ p.then(<strong>result</strong> &#x3D;&gt; { }, <strong>error</strong> &#x3D;&gt; { })<br>⚫ 调用 .then() 方法时，成功的回调函数是必选的、失败的回调函数是可选的</p>
<h2 id="2-基于回调函数按顺序读取文件内容"><a href="#2-基于回调函数按顺序读取文件内容" class="headerlink" title="2. 基于回调函数按顺序读取文件内容"></a>2. 基于回调函数按顺序读取文件内容</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 读取文件 1.txt</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err1, r1</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (err1) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err1.<span class="property">message</span>) <span class="comment">//读取文件1失败</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(r1) <span class="comment">//读取文件1成功</span></span><br><span class="line">	<span class="comment">//读取文件 2.txt</span></span><br><span class="line">	fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8 &#x27;</span>, <span class="function">(<span class="params">err2，r2</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (err2) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err2.<span class="property">message</span>) <span class="comment">//读取文件2失败</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(r2) <span class="comment">//读取文件2成功</span></span><br><span class="line">		<span class="comment">//读取文件 3.txt</span></span><br><span class="line">		fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>， <span class="string">&#x27;utf8 &#x27;</span>, <span class="function">(<span class="params">err3，r3</span>) =&gt;</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (err3) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err3.<span class="property">message</span>) <span class="comment">//读取文件3失败</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(r3) <span class="comment">//读取文件3成功</span></span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="3-基于-then-fs-读取文件内容"><a href="#3-基于-then-fs-读取文件内容" class="headerlink" title="3. 基于 then-fs 读取文件内容"></a>3. 基于 then-fs 读取文件内容</h2><p>由于 node.js 官方提供的 fs 模块<strong>仅支持</strong>以<strong>回调函数的方式</strong>读取文件，<strong>不支持 Promise 的调用方式</strong>。因此，需 要先运行如下的命令，安装 then-fs 这个第三方包，从而支持我们基于 Promise 的方式读取文件的内容：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install then-fs</span><br></pre></td></tr></table></figure>

<h3 id="3-1-then-fs-的基本使用"><a href="#3-1-then-fs-的基本使用" class="headerlink" title="3.1 then-fs 的基本使用"></a>3.1 then-fs 的基本使用</h3><p>调用 then-fs 提供的 <code>readFile()</code> 方法，可以异步地读取文件的内容，<strong>它的返回值是 Promise 的实例对象</strong>。因 此可以<strong>调用 <code>.then()</code> 方法</strong>为每个 Promise 异步操作指定<strong>成功</strong>和<strong>失败</strong>之后的回调函数。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thenFs <span class="keyword">from</span> <span class="string">&#x27;then-fs&#x27;</span></span><br><span class="line"></span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function"><span class="params">r1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">err1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err1.<span class="property">message</span>)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function"><span class="params">r2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">err2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err2.<span class="property">message</span>)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(</span><br><span class="line">  <span class="function"><span class="params">r3</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="params">err3</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err3.<span class="property">message</span>)</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>注意：上述的代码无法保证文件的读取顺序，需要做进一步的改进！</p>
<h3 id="3-2-then-方法的特性"><a href="#3-2-then-方法的特性" class="headerlink" title="3.2 .then() 方法的特性"></a>3.2 .then() 方法的特性</h3><p>如果上一个 .then() 方法中<strong>返回了一个新的 Promise 实例对象</strong>，则可以通过下一个 .then() 继续进行处理。通 过 .then() 方法的<strong>链式调用</strong>，就解决了回调地狱的问题。</p>
<h3 id="3-3-基于-Promise-按顺序读取文件的内容"><a href="#3-3-基于-Promise-按顺序读取文件的内容" class="headerlink" title="3.3 基于 Promise 按顺序读取文件的内容"></a>3.3 基于 Promise 按顺序读取文件的内容</h3><p><strong>Promise 支持链式调用</strong>，从而来解决回调地狱的问题。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">thenFs</span><br><span class="line">  .<span class="title function_">readFile</span>(<span class="string">&#x27;./files/11.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 1. 返回值是 Promise 的实例对象</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2. 通过 .then 为第一个 Promise 实例对象指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 3. 在第一个 .then 中返回一个新的 Promise 实例对象</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 4. 继续调用 .then 为上一个 .then 的返回值（新的 Promise 实例） 指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 5. 在第二个 .then 中再返回一个新的 Promise 实例对象</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r3</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 6. 继续调用 .then，为上一个 .then 的返回值（新的 Promise 实例） 指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="3-4-通过-catch-捕获错误"><a href="#3-4-通过-catch-捕获错误" class="headerlink" title="3.4 通过 .catch 捕获错误"></a>3.4 通过 .catch 捕获错误</h3><p>在 Promise 的链式操作中如果发生了错误，可以使用 <code>Promise.prototype.catch</code> 方法进行捕获和处理：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">thenFs</span><br><span class="line">  .<span class="title function_">readFile</span>(<span class="string">&#x27;./files/11.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 1. 返回值是 Promise 的实例对象</span></span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2. 通过 .then 为第一个 Promise 实例对象指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 3. 在第一个 .then 中返回一个新的 Promise 实例对象</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 4. 继续调用 .then 为上一个 .then 的返回值（新的 Promise 实例） 指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 5. 在第二个 .then 中再返回一个新的 Promise 实例对象</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r3</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 6. 继续调用 .then，为上一个 .then 的返回值（新的 Promise 实例） 指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 捕获第 1 行发生的错误，并输出错误的消息</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>如果不希望前面的错误导致后续的 .then 无法正常执行，则可以将 .catch 的调用提前，示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">thenFs</span><br><span class="line">  .<span class="title function_">readFile</span>(<span class="string">&#x27;./files/11.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 1. 返回值是 Promise 的实例对象</span></span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 捕获第 1 行发生的错误，并输出错误的消息</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>) <span class="comment">// 由于错误已被及时处理，不影响后续 .then 的正常执行</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2. 通过 .then 为第一个 Promise 实例对象指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 3. 在第一个 .then 中返回一个新的 Promise 实例对象</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 4. 继续调用 .then 为上一个 .then 的返回值（新的 Promise 实例） 指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">// 5. 在第二个 .then 中再返回一个新的 Promise 实例对象</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r3</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 6. 继续调用 .then，为上一个 .then 的返回值（新的 Promise 实例） 指定成功之后的回调函数</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="3-5-Promise-all-方法"><a href="#3-5-Promise-all-方法" class="headerlink" title="3.5 Promise.all() 方法"></a>3.5 Promise.all() 方法</h3><p>Promise.all() 方法会发起并行的 Promise 异步操作，等<strong>所有的异步操作全部结束后</strong>才会执行下一步的 .then 操作（等待机制）。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义一个数组，存放 3 个读文件的异步操作</span></span><br><span class="line"><span class="keyword">const</span> promiseArr = [thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>), thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>), thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 将 Promise 的数组，作为 Promise.all() 的参数</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>(promiseArr)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">[r1, r2, r3]</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2.1 所有文件读取成功（等待机制）</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r1, r2, r3)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2.2 捕获 Promise 异步操作中的错误</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>注意：数组中 Promise 实例的顺序， 就是最终结果的顺序！</p>
<h3 id="3-6-Promise-race-方法"><a href="#3-6-Promise-race-方法" class="headerlink" title="3.6 Promise.race() 方法"></a>3.6 Promise.race() 方法</h3><p>Promise.race() 方法会发起并行的 Promise 异步操作，<strong>只要任何一个异步操作完成，就立即执行下一步的 .then 操作</strong>（赛跑机制）。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 定义一个数组，存放 3 个读文件的异步操作</span></span><br><span class="line"><span class="keyword">const</span> promiseArr = [thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>), thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>), thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 将 Promise 的数组，作为 Promise.race() 的参数</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>(promiseArr)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2.1 只要任何一个异步操作完成，就立即执行成功的回调函数（赛跑机制）</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 2.2 捕获 Promise 异步操作中的错误</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="4-基于-Promise-封装读文件的方法-方法的封装要求："><a href="#4-基于-Promise-封装读文件的方法-方法的封装要求：" class="headerlink" title="4. 基于 Promise 封装读文件的方法 方法的封装要求："></a>4. 基于 Promise 封装读文件的方法 方法的封装要求：</h2><p>① 方法的名称要定义为 <strong>getFile</strong><br>② 方法接收一个<strong>形参 fpath</strong>，表示要读取的文件的路径<br>③ 方法的<strong>返回值</strong>为 Promise 实例对象</p>
<h3 id="4-1-getFile-方法的基本定义"><a href="#4-1-getFile-方法的基本定义" class="headerlink" title="4.1 getFile 方法的基本定义"></a>4.1 getFile 方法的基本定义</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 方法的名称为 getFile</span></span><br><span class="line"><span class="comment">// 2. 方法接收一个形参 fpath，表示要读取的文件的路径</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line">  <span class="comment">// 3. 方法的返回值为 Promise 的实例对象</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：第 5 行代码中的 <code>new Promise()</code> 只是创建了一个<strong>形式上的异步操作</strong>。</p>
<h3 id="4-2-创建具体的异步操作"><a href="#4-2-创建具体的异步操作" class="headerlink" title="4.2 创建具体的异步操作"></a>4.2 创建具体的异步操作</h3><p>如果想要创建<strong>具体的异步操作</strong>，则需要在 new Promise() 构造函数期间，<strong>传递一个 function 函数，将具体的 异步操作定义到 function 函数内部</strong>。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 方法的名称为 getFile</span></span><br><span class="line"><span class="comment">// 2. 方法接收一个形参 fpath，表示要读取的文件的路径</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line">  <span class="comment">// 3. 方法的返回值为 Promise 的实例对象</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 4. 下面这行代码，表示这是一个具体的、读文件的异步操作</span></span><br><span class="line">    fs.<span class="title function_">readFile</span>(fpath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err, dataStr</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-获取-then-的两个实参"><a href="#4-3-获取-then-的两个实参" class="headerlink" title="4.3 获取 .then 的两个实参"></a>4.3 获取 .then 的两个实参</h3><p>通过 .then() 指定的<strong>成功</strong>和<strong>失败</strong>的回调函数，可以在 function 的<strong>形参中</strong> resolve reject 进行接收，示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line">  <span class="comment">// resolve 形参是：调用 getFile() 方法时，通过 .then 指定的“成功的”回调函数</span></span><br><span class="line">  <span class="comment">// reject 形参是：调用 getFile() 方法时，通过 .then 指定的“失败的”回调函数</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    fs.<span class="title function_">readFile</span>(fpath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err, dataStr</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// getFile 方法的调用过程</span></span><br><span class="line"><span class="title function_">getFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>).<span class="title function_">then</span>(成功的回调函数, 失败的回调函数)</span><br></pre></td></tr></table></figure>

<h3 id="4-4-调用-resolve-和-reject-回调函数"><a href="#4-4-调用-resolve-和-reject-回调函数" class="headerlink" title="4.4 调用 resolve 和 reject 回调函数"></a>4.4 调用 resolve 和 reject 回调函数</h3><p>Promise <strong>异步操作的结果</strong>，可以调用 <strong>resolve</strong> 或 <strong>reject</strong> 回调函数进行处理。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line">  <span class="comment">// resolve 是“成功的”回调函数；reject 是“失败的”回调函数</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    fs.<span class="title function_">readFile</span>(fpath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err, dataStr</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (err) <span class="keyword">return</span> <span class="title function_">reject</span>(err) <span class="comment">// 如果读取失败，则调用“失败的回调函数”</span></span><br><span class="line">      <span class="title function_">resolve</span>(dataStr) <span class="comment">// 如果读取成功，则调用“成功的回调函数”</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// getFile 方法的调用过程：</span></span><br><span class="line"><span class="title function_">getFile</span>(<span class="string">&#x27;./files/11.txt&#x27;</span>).<span class="title function_">then</span>(成功的回调函数, 失败的回调函数)</span><br></pre></td></tr></table></figure>

<h1 id="async-await"><a href="#async-await" class="headerlink" title="async&#x2F;await"></a>async&#x2F;await</h1><h2 id="1-什么是-async-await"><a href="#1-什么是-async-await" class="headerlink" title="1. 什么是 async&#x2F;await"></a>1. 什么是 async&#x2F;await</h2><p>async&#x2F;await 是 ES8（ECMAScript 2017）引入的新语法，用来简化 Promise 异步操作。在 async&#x2F;await 出 现之前，开发者只能通过链式 .then() 的方式处理 Promise 异步操作。示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">thenFs</span><br><span class="line">  .<span class="title function_">readFile</span>(<span class="string">&#x27;./files/11.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r1</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r2</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">    <span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function"><span class="params">r3</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>

<p>.then 链式调用的优点： 解决了回调地狱的问题<br>.then 链式调用的缺点： 代码冗余、阅读性差、 不易理解</p>
<h2 id="2-async-await-的基本使用"><a href="#2-async-await-的基本使用" class="headerlink" title="2. async&#x2F;await 的基本使用"></a>2. async&#x2F;await 的基本使用</h2><p>使用 async&#x2F;await 简化 Promise 异步操作的示例代码如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thenFs <span class="keyword">from</span> <span class="string">&#x27;then-fs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 按照顺序读取文件 1,2,3 的内容</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getAllFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> r1 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">  <span class="keyword">const</span> r2 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">  <span class="keyword">const</span> r3 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getAllFile</span>()</span><br></pre></td></tr></table></figure>

<h2 id="3-async-await-的使用注意事项"><a href="#3-async-await-的使用注意事项" class="headerlink" title="3. async&#x2F;await 的使用注意事项"></a>3. async&#x2F;await 的使用注意事项</h2><p>① 如果在 function 中使用了 await，则 function 必须被 async 修饰<br>② 在 async 方法中，第一个 await 之前的代码会同步执行，await 之后的代码会异步执行</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getAllFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> r1 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">  <span class="keyword">const</span> r2 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">  <span class="keyword">const</span> r3 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getAllFile</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;C&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 最终输出的顺序</span><br><span class="line">A</span><br><span class="line">B</span><br><span class="line">C</span><br><span class="line">111 222 333</span><br><span class="line">D</span><br></pre></td></tr></table></figure>

<h1 id="EventLoop"><a href="#EventLoop" class="headerlink" title="EventLoop"></a>EventLoop</h1><h2 id="1-JavaScript-是单线程的语言"><a href="#1-JavaScript-是单线程的语言" class="headerlink" title="1. JavaScript 是单线程的语言"></a>1. JavaScript 是单线程的语言</h2><p>JavaScript 是一门单线程执行的编程语言。也就是说，同一时间只能做一件事情。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/article/Vue/image-20220522133534124.png" alt="image-20220522133534124"></p>
<p>单线程执行任务队列的问题： 如果前一个任务非常耗时，则后续的任务就不得不一直等待，从而导致程序假死的问题。</p>
<h2 id="2-同步任务和异步任务"><a href="#2-同步任务和异步任务" class="headerlink" title="2. 同步任务和异步任务"></a>2. 同步任务和异步任务</h2><p>为了防止某个耗时任务导致程序假死的问题，JavaScript 把待执行的任务分为了两类：</p>
<p>① 同步任务（synchronous）</p>
<p>⚫ 又叫做非耗时任务，指的是在主线程上排队执行的那些任务<br>⚫ 只有前一个任务执行完毕，才能执行后一个任务</p>
<p>② 异步任务（asynchronous）</p>
<p>⚫ 又叫做耗时任务，异步任务由 JavaScript 委托给宿主环境进行执行<br>⚫ 当异步任务执行完成后，会通知 JavaScript 主线程执行异步任务的回调函数</p>
<h2 id="3-同步任务和异步任务的执行过程"><a href="#3-同步任务和异步任务的执行过程" class="headerlink" title="3. 同步任务和异步任务的执行过程"></a>3. 同步任务和异步任务的执行过程</h2><p>① 同步任务由 JavaScript 主线程次序执行<br>② 异步任务委托给宿主环境执行<br>③ 已完成的异步任务对应的回调函数，会被加入到任务队列中等待执行<br>④ JavaScript 主线程的执行栈被清空后，会读取任务队列中的回调函数，次序执行<br>⑤ JavaScript 主线程不断重复上面的第 4 步</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/article/Vue/image-20220522133714733.png" alt="image-20220522133714733"></p>
<h2 id="4-EventLoop-的基本概念"><a href="#4-EventLoop-的基本概念" class="headerlink" title="4. EventLoop 的基本概念"></a>4. EventLoop 的基本概念</h2><p>JavaScript 主线程从“任务队列”中读取异步任务的回调函数，放到执行栈中依次执行。这个过程是循环不断的，所以整个的这种运行机制又称为 EventLoop（事件循环）。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/article/Vue/image-20220522133832445.png" alt="image-20220522133832445"></p>
<h2 id="4-结合-EventLoop-分析输出的顺序"><a href="#4-结合-EventLoop-分析输出的顺序" class="headerlink" title="4. 结合 EventLoop 分析输出的顺序"></a>4. 结合 EventLoop 分析输出的顺序</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thenFs <span class="keyword">from</span> <span class="string">&#x27;then-fs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">dataStr</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;D&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>正确的输出结果：ADCB。其中：<br>⚫ A 和 D 属于同步任务。会根据代码的先后顺序依次被执行<br>⚫ C 和 B 属于异步任务。它们的回调函数会被加入到任务队列中，等待主线程空闲时再执行</p>
<h1 id="宏任务和微任务"><a href="#宏任务和微任务" class="headerlink" title="宏任务和微任务"></a>宏任务和微任务</h1><h2 id="1-什么是宏任务和微任务"><a href="#1-什么是宏任务和微任务" class="headerlink" title="1. 什么是宏任务和微任务"></a>1. 什么是宏任务和微任务</h2><p>JavaScript 把异步任务又做了进一步的划分，异步任务又分为两类，分别是：</p>
<p>① 宏任务（macrotask）</p>
<p>⚫ 异步 Ajax 请求、<br>⚫ setTimeout、setInterval、<br>⚫ 文件操作<br>⚫ 其它宏任务</p>
<p>② 微任务（microtask）</p>
<p>⚫ Promise.then、.catch 和 .finally<br>⚫ process.nextTick<br>⚫ 其它微任务</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/article/Vue/image-20220522134526315.png" alt="image-20220522134526315"></p>
<h2 id="2-宏任务和微任务的执行顺序"><a href="#2-宏任务和微任务的执行顺序" class="headerlink" title="2. 宏任务和微任务的执行顺序"></a>2. 宏任务和微任务的执行顺序</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/article/Vue/image-20220522134659281.png" alt="image-20220522134659281"></p>
<p>每一个宏任务执行完之后，都会检查是否存在待执行的微任务，<br>如果有，则执行完所有微任务之后，再继续执行下一个宏任务。</p>
<h2 id="3-去银行办业务的场景"><a href="#3-去银行办业务的场景" class="headerlink" title="3. 去银行办业务的场景"></a>3. 去银行办业务的场景</h2><p>① 小云和小腾去银行办业务。首先，需要取号之后进行排队</p>
<p>⚫ 宏任务队列</p>
<p>② 假设当前银行网点只有一个柜员，小云在办理存款业务时，小腾只能等待</p>
<p>⚫ 单线程，宏任务按次序执行</p>
<p>③ 小云办完存款业务后，柜员询问他是否还想办理其它业务？</p>
<p>⚫ 当前宏任务执行完，检查是否有微任务</p>
<p>④ 小云告诉柜员：想要买理财产品、再办个信用卡、最后再兑换点马年纪念币？</p>
<p>⚫ 执行微任务，后续宏任务被推迟</p>
<p>⑤ 小云离开柜台后，柜员开始为小腾办理业务</p>
<p>⚫ 所有微任务执行完毕，开始执行下一个宏任务</p>
<h2 id="4-分析以下代码输出的顺序"><a href="#4-分析以下代码输出的顺序" class="headerlink" title="4. 分析以下代码输出的顺序"></a>4. 分析以下代码输出的顺序</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">  <span class="title function_">resolve</span>()</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;4&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>正确的输出顺序是：2431</p>
<p>分析：<br>① 先执行所有的同步任务<br>⚫ 执行第 6 行、第 12 行代码<br>② 再执行微任务<br>⚫ 执行第 9 行代码<br>③ 再执行下一个宏任务<br>⚫ 执行第 2 行代码</p>
<h2 id="5-经典面试题"><a href="#5-经典面试题" class="headerlink" title="5. 经典面试题"></a>5. 经典面试题</h2><p>请分析以下代码输出的顺序 ：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">        <span class="title function_">resolve</span>()</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;5)</span></span><br><span class="line"><span class="string">    resolve()</span></span><br><span class="line"><span class="string">&#125;).then(function() &#123;</span></span><br><span class="line"><span class="string">    console.log(&#x27;</span><span class="number">6</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string">setTimeout(function() &#123;</span></span><br><span class="line"><span class="string">    console.log(&#x27;</span><span class="number">7</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">    new Promise(function(resolve) &#123;</span></span><br><span class="line"><span class="string">        console.log(&#x27;</span><span class="number">8</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">        resolve()</span></span><br><span class="line"><span class="string">    &#125;).then(function() &#123;</span></span><br><span class="line"><span class="string">        console.log(&#x27;</span><span class="number">9</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">&#125;)</span></span><br></pre></td></tr></table></figure>

<p>正确的输出顺序是：156234789</p>
<h1 id="API-接口案例"><a href="#API-接口案例" class="headerlink" title="API 接口案例"></a>API 接口案例</h1><h2 id="1-案例需求"><a href="#1-案例需求" class="headerlink" title="1. 案例需求"></a>1. 案例需求</h2><p>基于 MySQL 数据库 + Express 对外提供用户列表的 API 接口服务。用到的技术点如下：<br>⚫ 第三方包 express 和 mysql2<br>⚫ ES6 模块化<br>⚫ Promise<br>⚫ async&#x2F;await</p>
<h2 id="2-主要的实现步骤"><a href="#2-主要的实现步骤" class="headerlink" title="2. 主要的实现步骤"></a>2. 主要的实现步骤</h2><p>① 搭建项目的基本结构<br>② 创建基本的服务器<br>③ 创建 db 数据库操作模块<br>④ 创建 user_ctrl 业务模块<br>⑤ 创建 user_router 路由模块</p>
<h2 id="3-搭建项目的基本结构"><a href="#3-搭建项目的基本结构" class="headerlink" title="3. 搭建项目的基本结构"></a>3. 搭建项目的基本结构</h2><p>① 启用 ES6 模块化支持<br>⚫ 在 package.json 中声明 “type”: “module”<br>② 安装第三方依赖包<br>⚫ 运行 npm install <a href="mailto:&#x65;&#120;&#112;&#x72;&#x65;&#115;&#x73;&#64;&#x34;&#46;&#49;&#55;&#46;&#x31;">&#x65;&#120;&#112;&#x72;&#x65;&#115;&#x73;&#64;&#x34;&#46;&#49;&#55;&#46;&#x31;</a> <a href="mailto:&#109;&#x79;&#115;&#113;&#108;&#50;&#x40;&#50;&#x2e;&#x32;&#x2e;&#x35;">&#109;&#x79;&#115;&#113;&#108;&#50;&#x40;&#50;&#x2e;&#x32;&#x2e;&#x35;</a></p>
<h2 id="4-创建基本的服务器"><a href="#4-创建基本的服务器" class="headerlink" title="4. 创建基本的服务器"></a>4. 创建基本的服务器</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 ES6 的默认导入语法</span></span><br><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="5-创建-db-数据库操作模块"><a href="#5-创建-db-数据库操作模块" class="headerlink" title="5. 创建 db 数据库操作模块"></a>5. 创建 db 数据库操作模块</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mysql <span class="keyword">from</span> <span class="string">&#x27;mysql2&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> pool = mysql.<span class="title function_">creatPool</span>(&#123;</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">  <span class="attr">port</span>: <span class="number">3306</span>,</span><br><span class="line">  <span class="attr">database</span>: <span class="string">&#x27;my_db_01&#x27;</span>, <span class="comment">// 请填写要操作的数据库的名称</span></span><br><span class="line">  <span class="attr">user</span>: <span class="string">&#x27;root&#x27;</span>, <span class="comment">// 请填写登录数据库的用户名</span></span><br><span class="line">  <span class="attr">password</span>: <span class="string">&#x27;admin123&#x27;</span> <span class="comment">// 请填写登录数据库的密码</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认导出一个文件 Promise API 的 pool</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> pool.<span class="title function_">promise</span>()</span><br></pre></td></tr></table></figure>

<h2 id="6-创建-user-ctrl-模块"><a href="#6-创建-user-ctrl-模块" class="headerlink" title="6. 创建 user_ctrl 模块"></a>6. 创建 user_ctrl 模块</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> db <span class="keyword">from</span> <span class="string">&#x27;../db/index.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取所有用户的列表数据</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getAllUser</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// db.query() 函数的返回值是 Promise 的实例对象。因此，可以使用 async/await 进行简化</span></span><br><span class="line">  <span class="keyword">const</span> [rows] = <span class="keyword">await</span> db.<span class="title function_">query</span>(<span class="string">&#x27;select id, username, nickname, xxx from ev_users&#x27;</span>)</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="attr">message</span>: <span class="string">&#x27;获取用户列表数据成功！&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: rows</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-创建-user-router-模块"><a href="#7-创建-user-router-模块" class="headerlink" title="7. 创建 user_router 模块"></a>7. 创建 user_router 模块</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span></span><br><span class="line"><span class="comment">// 从 user_ctrl.js 模块中按需导入 getAllUser 函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; getAllUser &#125; <span class="keyword">from</span> <span class="string">&#x27;../controller/user_ctrl.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建路由对象</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> express.<span class="title class_">Router</span>()</span><br><span class="line"><span class="comment">// 挂载路由规则</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/user&#x27;</span>, getAllUser)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 ES6 的默认导出语法，将路由对象共享出去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>

<h2 id="8-导入并挂载路由模块"><a href="#8-导入并挂载路由模块" class="headerlink" title="8. 导入并挂载路由模块"></a>8. 导入并挂载路由模块</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> express <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span></span><br><span class="line"><span class="comment">// 1. 使用默认导入语法，导入路由对象</span></span><br><span class="line"><span class="keyword">import</span> userRouter <span class="keyword">from</span> <span class="string">&#x27;./router/user_router.js&#x27;</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 挂载用户路由模块</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/api&#x27;</span>, userRouter)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;server running at http://127.0.0.1&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="9-使用-try…catch-捕获异常"><a href="#9-使用-try…catch-捕获异常" class="headerlink" title="9. 使用 try…catch 捕获异常"></a>9. 使用 try…catch 捕获异常</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getAllUser</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// ev_users 表中没有 xxx 字段，所以此 SQL 语句会“执行异常”</span></span><br><span class="line">    <span class="keyword">const</span> [rows] = <span class="keyword">await</span> db.<span class="title function_">query</span>(<span class="string">&#x27;select id, username, nickname, xxx from ev_users&#x27;</span>)</span><br><span class="line">    res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">0</span>, <span class="attr">message</span>: <span class="string">&#x27;获取用户列表数据成功！&#x27;</span>, <span class="attr">data</span>: rows &#125;)</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(&#123; <span class="attr">status</span>: <span class="number">1</span>, <span class="attr">message</span>: <span class="string">&#x27;获取用户列表数据失败！&#x27;</span>, <span class="attr">desc</span>: err.<span class="property">message</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>① 能够知道如何使用 ES6 的模块化语法<br>⚫ 默认导出与默认导入、按需导出与按需导入</p>
<p>② 能够知道如何使用 Promise 解决回调地狱问题<br>⚫ promise.then()、promise.catch()</p>
<p>③ 能够使用 async&#x2F;await 简化 Promise 的调用<br>⚫ 方法中用到了 await，则方法需要被 async 修饰</p>
<p>④ 能够说出什么是 EventLoop<br>⚫ EventLoop 示意图</p>
<p>⑤ 能够说出宏任务和微任务的执行顺序<br>⚫ 在执行下一个宏任务之前，先检查是否有待执行的微任务</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/avatar/avatar.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/avatar/avatar.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Ramsayi</div><div class="post-copyright__author_desc">这个人很懒，什么都填了</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://ramsayi.asia/posts/6d870065/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://ramsayi.asia/posts/6d870065/')">（零）ES6模块化与异步编程高级用法</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/wechat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/wechat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/others/alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://ramsayi.asia/posts/6d870065/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=（零）ES6模块化与异步编程高级用法&amp;url=https://ramsayi.asia/posts/6d870065/&amp;pic=https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://ramsayi.asia" target="_blank">Ramsayi</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>技术学习<span class="categoryesPageCount">240</span></a><a class="post-meta__box__categoryes" href="/categories/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/Vue/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>Vue<span class="categoryesPageCount">12</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Vue3/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Vue3<span class="tagsPageCount">10</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/windows11.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/d7f18edd/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">（八）Vue基础-综合案例</div></div></a></div><div class="next-post pull-right"><a href="/posts/3fa2fffe/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/react.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">react基础Day01-React概述&amp;脚手架搭建&amp;JSX&amp;组件</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/87137f47/" title="（一）前端工程化与webpack"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/webpack.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-04-20</div><div class="title">（一）前端工程化与webpack</div></div></a></div><div><a href="/posts/e574c01a/" title="（七）路由"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-04-28</div><div class="title">（七）路由</div></div></a></div><div><a href="/posts/56ee636f/" title="（三）组件基础（上）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-04-23</div><div class="title">（三）组件基础（上）</div></div></a></div><div><a href="/posts/a7d23c1/" title="（九）Vue全家桶-Vuex"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vuex.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-05-04</div><div class="title">（九）Vue全家桶-Vuex</div></div></a></div><div><a href="/posts/4f072fd7/" title="（二）Vue基础入门"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-04-21</div><div class="title">（二）Vue基础入门</div></div></a></div><div><a href="/posts/8228db57/" title="（五）组件高级（上）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/vue3.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2022-04-28</div><div class="title">（五）组件高级（上）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/avatar/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Ramsayi</h1><div class="author-info__desc">这个人很懒，什么都填了</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/ramsayi" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/354247938" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ES6-%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">1.</span> <span class="toc-text">ES6 模块化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9B%9E%E9%A1%BE%EF%BC%9Anode-js-%E4%B8%AD%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">1.1.</span> <span class="toc-text">1. 回顾：node.js 中如何实现模块化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96%E8%A7%84%E8%8C%83%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">2.前端模块化规范的分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BB%80%E4%B9%88%E6%98%AF-ES6-%E6%A8%A1%E5%9D%97%E5%8C%96%E8%A7%84%E8%8C%83"><span class="toc-number">1.3.</span> <span class="toc-text">3.什么是 ES6 模块化规范</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%9C%A8-node-js-%E4%B8%AD%E4%BD%93%E9%AA%8C-ES6-%E6%A8%A1%E5%9D%97%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text">4.在 node.js 中体验 ES6 模块化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-ES6-%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.5.</span> <span class="toc-text">5.ES6 模块化的基本语法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%BB%98%E8%AE%A4%E5%AF%BC%E5%87%BA"><span class="toc-number">1.5.1.</span> <span class="toc-text">5.1 默认导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%BB%98%E8%AE%A4%E5%AF%BC%E5%85%A5"><span class="toc-number">1.5.2.</span> <span class="toc-text">5.1 默认导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E9%BB%98%E8%AE%A4%E5%AF%BC%E5%87%BA%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.5.3.</span> <span class="toc-text">5.1 默认导出的注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%8C%89%E9%9C%80%E5%AF%BC%E5%87%BA"><span class="toc-number">1.5.4.</span> <span class="toc-text">5.2 按需导出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%8C%89%E9%9C%80%E5%AF%BC%E5%85%A5"><span class="toc-number">1.5.5.</span> <span class="toc-text">5.2 按需导入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E6%8C%89%E9%9C%80%E5%AF%BC%E5%87%BA%E4%B8%8E%E6%8C%89%E9%9C%80%E5%AF%BC%E5%85%A5%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.5.6.</span> <span class="toc-text">5.2 按需导出与按需导入的注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E7%9B%B4%E6%8E%A5%E5%AF%BC%E5%85%A5%E5%B9%B6%E6%89%A7%E8%A1%8C%E6%A8%A1%E5%9D%97%E4%B8%AD%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number">1.5.7.</span> <span class="toc-text">5.3 直接导入并执行模块中的代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Promise"><span class="toc-number">2.</span> <span class="toc-text">Promise</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1"><span class="toc-number">2.1.</span> <span class="toc-text">1. 回调地狱</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%9B%9E%E8%B0%83%E5%9C%B0%E7%8B%B1%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1 如何解决回调地狱的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Promise-%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.2 Promise 的基本概念</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%9F%BA%E4%BA%8E%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E6%8C%89%E9%A1%BA%E5%BA%8F%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">2.2.</span> <span class="toc-text">2. 基于回调函数按顺序读取文件内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%9F%BA%E4%BA%8E-then-fs-%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">2.3.</span> <span class="toc-text">3. 基于 then-fs 读取文件内容</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-then-fs-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">2.3.1.</span> <span class="toc-text">3.1 then-fs 的基本使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-then-%E6%96%B9%E6%B3%95%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-number">2.3.2.</span> <span class="toc-text">3.2 .then() 方法的特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E5%9F%BA%E4%BA%8E-Promise-%E6%8C%89%E9%A1%BA%E5%BA%8F%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-number">2.3.3.</span> <span class="toc-text">3.3 基于 Promise 按顺序读取文件的内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E9%80%9A%E8%BF%87-catch-%E6%8D%95%E8%8E%B7%E9%94%99%E8%AF%AF"><span class="toc-number">2.3.4.</span> <span class="toc-text">3.4 通过 .catch 捕获错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-Promise-all-%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.5.</span> <span class="toc-text">3.5 Promise.all() 方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-Promise-race-%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.6.</span> <span class="toc-text">3.6 Promise.race() 方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%9F%BA%E4%BA%8E-Promise-%E5%B0%81%E8%A3%85%E8%AF%BB%E6%96%87%E4%BB%B6%E7%9A%84%E6%96%B9%E6%B3%95-%E6%96%B9%E6%B3%95%E7%9A%84%E5%B0%81%E8%A3%85%E8%A6%81%E6%B1%82%EF%BC%9A"><span class="toc-number">2.4.</span> <span class="toc-text">4. 基于 Promise 封装读文件的方法 方法的封装要求：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-getFile-%E6%96%B9%E6%B3%95%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%AE%9A%E4%B9%89"><span class="toc-number">2.4.1.</span> <span class="toc-text">4.1 getFile 方法的基本定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E5%88%9B%E5%BB%BA%E5%85%B7%E4%BD%93%E7%9A%84%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">2.4.2.</span> <span class="toc-text">4.2 创建具体的异步操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E8%8E%B7%E5%8F%96-then-%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%AE%9E%E5%8F%82"><span class="toc-number">2.4.3.</span> <span class="toc-text">4.3 获取 .then 的两个实参</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-%E8%B0%83%E7%94%A8-resolve-%E5%92%8C-reject-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">2.4.4.</span> <span class="toc-text">4.4 调用 resolve 和 reject 回调函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#async-await"><span class="toc-number">3.</span> <span class="toc-text">async&#x2F;await</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF-async-await"><span class="toc-number">3.1.</span> <span class="toc-text">1. 什么是 async&#x2F;await</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-async-await-%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">2. async&#x2F;await 的基本使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-async-await-%E7%9A%84%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">3.3.</span> <span class="toc-text">3. async&#x2F;await 的使用注意事项</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#EventLoop"><span class="toc-number">4.</span> <span class="toc-text">EventLoop</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-JavaScript-%E6%98%AF%E5%8D%95%E7%BA%BF%E7%A8%8B%E7%9A%84%E8%AF%AD%E8%A8%80"><span class="toc-number">4.1.</span> <span class="toc-text">1. JavaScript 是单线程的语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%90%8C%E6%AD%A5%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-number">4.2.</span> <span class="toc-text">2. 同步任务和异步任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%8C%E6%AD%A5%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-number">4.3.</span> <span class="toc-text">3. 同步任务和异步任务的执行过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-EventLoop-%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">4.4.</span> <span class="toc-text">4. EventLoop 的基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E7%BB%93%E5%90%88-EventLoop-%E5%88%86%E6%9E%90%E8%BE%93%E5%87%BA%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-number">4.5.</span> <span class="toc-text">4. 结合 EventLoop 分析输出的顺序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%8F%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%BE%AE%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.</span> <span class="toc-text">宏任务和微任务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%8F%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%BE%AE%E4%BB%BB%E5%8A%A1"><span class="toc-number">5.1.</span> <span class="toc-text">1. 什么是宏任务和微任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AE%8F%E4%BB%BB%E5%8A%A1%E5%92%8C%E5%BE%AE%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F"><span class="toc-number">5.2.</span> <span class="toc-text">2. 宏任务和微任务的执行顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%8E%BB%E9%93%B6%E8%A1%8C%E5%8A%9E%E4%B8%9A%E5%8A%A1%E7%9A%84%E5%9C%BA%E6%99%AF"><span class="toc-number">5.3.</span> <span class="toc-text">3. 去银行办业务的场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%86%E6%9E%90%E4%BB%A5%E4%B8%8B%E4%BB%A3%E7%A0%81%E8%BE%93%E5%87%BA%E7%9A%84%E9%A1%BA%E5%BA%8F"><span class="toc-number">5.4.</span> <span class="toc-text">4. 分析以下代码输出的顺序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%BB%8F%E5%85%B8%E9%9D%A2%E8%AF%95%E9%A2%98"><span class="toc-number">5.5.</span> <span class="toc-text">5. 经典面试题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#API-%E6%8E%A5%E5%8F%A3%E6%A1%88%E4%BE%8B"><span class="toc-number">6.</span> <span class="toc-text">API 接口案例</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A1%88%E4%BE%8B%E9%9C%80%E6%B1%82"><span class="toc-number">6.1.</span> <span class="toc-text">1. 案例需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%B8%BB%E8%A6%81%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.2.</span> <span class="toc-text">2. 主要的实现步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BA%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-number">6.3.</span> <span class="toc-text">3. 搭建项目的基本结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E5%9F%BA%E6%9C%AC%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">6.4.</span> <span class="toc-text">4. 创建基本的服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%88%9B%E5%BB%BA-db-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%9D%97"><span class="toc-number">6.5.</span> <span class="toc-text">5. 创建 db 数据库操作模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%88%9B%E5%BB%BA-user-ctrl-%E6%A8%A1%E5%9D%97"><span class="toc-number">6.6.</span> <span class="toc-text">6. 创建 user_ctrl 模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%88%9B%E5%BB%BA-user-router-%E6%A8%A1%E5%9D%97"><span class="toc-number">6.7.</span> <span class="toc-text">7. 创建 user_router 模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%AF%BC%E5%85%A5%E5%B9%B6%E6%8C%82%E8%BD%BD%E8%B7%AF%E7%94%B1%E6%A8%A1%E5%9D%97"><span class="toc-number">6.8.</span> <span class="toc-text">8. 导入并挂载路由模块</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E4%BD%BF%E7%94%A8-try%E2%80%A6catch-%E6%8D%95%E8%8E%B7%E5%BC%82%E5%B8%B8"><span class="toc-number">6.9.</span> <span class="toc-text">9. 使用 try…catch 捕获异常</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/fc876b88/" title="GitKraken简体中文"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/bg/wallhaven-exrvgk.png?_r_=5caa76ea-6054-4a8b-611c-b453e0777544" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GitKraken简体中文"/></a><div class="content"><a class="title" href="/posts/fc876b88/" title="GitKraken简体中文">GitKraken简体中文</a><time datetime="2024-01-16T03:35:53.000Z" title="发表于 2024-01-16 11:35:53">2024-01-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/227d2de3/" title="Windows环境配置"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/windows11.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows环境配置"/></a><div class="content"><a class="title" href="/posts/227d2de3/" title="Windows环境配置">Windows环境配置</a><time datetime="2024-01-15T08:23:49.000Z" title="发表于 2024-01-15 16:23:49">2024-01-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/947f8646/" title="虚幻5 - 入门教程 - GenJi 欧酱"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/banner/ue5.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="虚幻5 - 入门教程 - GenJi 欧酱"/></a><div class="content"><a class="title" href="/posts/947f8646/" title="虚幻5 - 入门教程 - GenJi 欧酱">虚幻5 - 入门教程 - GenJi 欧酱</a><time datetime="2023-11-21T15:31:43.000Z" title="发表于 2023-11-21 23:31:43">2023-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b2d509e5/" title="OneDrive自定义云同步文件夹"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/bg/wallhaven-qz5pyd.png?_r_=0c3c1d3d-df2c-7cdf-efda-015d366996f0" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OneDrive自定义云同步文件夹"/></a><div class="content"><a class="title" href="/posts/b2d509e5/" title="OneDrive自定义云同步文件夹">OneDrive自定义云同步文件夹</a><time datetime="2023-10-17T04:41:17.000Z" title="发表于 2023-10-17 12:41:17">2023-10-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/36da500e/" title="SARscape中SAR数据处理准备工作总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/bg/wallhaven-wewvxp.png?_r_=336320c3-9293-93a2-bdde-b2f3f824227f" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SARscape中SAR数据处理准备工作总结"/></a><div class="content"><a class="title" href="/posts/36da500e/" title="SARscape中SAR数据处理准备工作总结">SARscape中SAR数据处理准备工作总结</a><time datetime="2023-09-19T11:36:30.000Z" title="发表于 2023-09-19 19:36:30">2023-09-19</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:anzhiyu-c@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/6378063631" title="微博"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=100092208016287&amp;sk=about" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/ramsayi/assets/avatar/avatar.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/372204786" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/DwCpMEy/" title="抖音"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a><a class="deal_link" href="/copyright" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">主题</div><div class="footer-links"><a class="footer-item" title="文档" target="_blank" rel="noopener" href="https://docs.anheyu.com/">文档</a><a class="footer-item" title="源码" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu">源码</a><a class="footer-item" title="更新日志" href="/update/">更新日志</a></div></div><div class="footer-group"><div class="footer-title">导航</div><div class="footer-links"><a class="footer-item" title="即刻短文" href="/essay/">即刻短文</a><a class="footer-item" title="友链文章" href="/fcircle/">友链文章</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://www.dogecloud.com/" style="margin-inline:5px" data-title="本站使用多吉云为静态资源提供CDN加速" title="本站使用多吉云为静态资源提供CDN加速"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/CDN-多吉云-3693F3.svg" alt="本站使用多吉云为静态资源提供CDN加速"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2018 - 2024 By <a class="footer-bar-link" href="/" title="Ramsayi" target="_blank">Ramsayi</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType () {
  getScript('https://sdk.jinrishici.com/v2/browser/jinrishici.js').then(() => {
    jinrishici.load(result =>{
      if (true) {
        const sub = []
        const content = result.data.content
        sub.unshift(content)
        window.typed = new Typed('#footer-type-tips', {
          strings: sub,
          startDelay: 300,
          typeSpeed: 150,
          loop: true,
          backSpeed: 50,
        })
      } else {
        document.getElementById('footer-type-tips').innerHTML = result.data.content
      }
    })
  })
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js').then(subtitleType)
  }
} else {
  subtitleType()
}
</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a><a class="footer-bar-link" target="_blank" rel="noopener" href="https://image.anheyu.com" title="图床">图床</a><a class="footer-bar-link cc" href="/copyright" title="cc协议"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-by-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nc-line"></i><i class="anzhiyufont anzhiyu-icon-creative-commons-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">265</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">50</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">42</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://ramsayi.asia/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://aabbk.github.io" title="网址导航"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="网址导航"/><span class="back-menu-item-text">网址导航</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://scabet.github.io" title="Scabet"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Scabet"/><span class="back-menu-item-text">Scabet</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://aabbt.github.io/" title="Aabbt"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="Aabbt"/><span class="back-menu-item-text">Aabbt</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://swclub.github.io/" title="SWClub"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="SWClub"/><span class="back-menu-item-text">SWClub</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://aabbs.github.io/" title="花里胡哨"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://blog.anheyu.com/favicon.ico" alt="花里胡哨"/><span class="back-menu-item-text">花里胡哨</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/airConditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/technologyStack/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 技术栈</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Axios/" style="font-size: 0.88rem;">Axios<sup>1</sup></a><a href="/tags/Bilibili/" style="font-size: 0.88rem;">Bilibili<sup>1</sup></a><a href="/tags/C/" style="font-size: 0.88rem;">C++<sup>35</sup></a><a href="/tags/C-%E7%90%86%E8%AE%BA%E7%BB%BC%E5%90%88%E4%BD%9C%E4%B8%9A/" style="font-size: 0.88rem;">C++理论综合作业<sup>4</sup></a><a href="/tags/Curl/" style="font-size: 0.88rem;">Curl<sup>1</sup></a><a href="/tags/Dart/" style="font-size: 0.88rem;">Dart<sup>114</sup></a><a href="/tags/ECharts/" style="font-size: 0.88rem;">ECharts<sup>4</sup></a><a href="/tags/Excel/" style="font-size: 0.88rem;">Excel<sup>1</sup></a><a href="/tags/FFmpeg/" style="font-size: 0.88rem;">FFmpeg<sup>1</sup></a><a href="/tags/Flutter/" style="font-size: 0.88rem;">Flutter<sup>114</sup></a><a href="/tags/Getx/" style="font-size: 0.88rem;">Getx<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>2</sup></a><a href="/tags/GitKraken/" style="font-size: 0.88rem;">GitKraken<sup>1</sup></a><a href="/tags/Hexo/" style="font-size: 0.88rem;">Hexo<sup>3</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>7</sup></a><a href="/tags/Jupyter/" style="font-size: 0.88rem;">Jupyter<sup>1</sup></a><a href="/tags/Markdown/" style="font-size: 0.88rem;">Markdown<sup>1</sup></a><a href="/tags/OneDrive/" style="font-size: 0.88rem;">OneDrive<sup>1</sup></a><a href="/tags/Python/" style="font-size: 0.88rem;">Python<sup>10</sup></a><a href="/tags/React/" style="font-size: 0.88rem;">React<sup>9</sup></a><a href="/tags/SARscape/" style="font-size: 0.88rem;">SARscape<sup>1</sup></a><a href="/tags/Sentinel/" style="font-size: 0.88rem;">Sentinel<sup>1</sup></a><a href="/tags/TypeScript/" style="font-size: 0.88rem;">TypeScript<sup>7</sup></a><a href="/tags/Ubuntu/" style="font-size: 0.88rem;">Ubuntu<sup>2</sup></a><a href="/tags/Unity3D/" style="font-size: 0.88rem;">Unity3D<sup>1</sup></a><a href="/tags/VSCode/" style="font-size: 0.88rem;">VSCode<sup>1</sup></a><a href="/tags/Vim/" style="font-size: 0.88rem;">Vim<sup>1</sup></a><a href="/tags/Vue2/" style="font-size: 0.88rem;">Vue2<sup>2</sup></a><a href="/tags/Vue3/" style="font-size: 0.88rem;">Vue3<sup>10</sup></a><a href="/tags/Windows/" style="font-size: 0.88rem;">Windows<sup>1</sup></a><a href="/tags/You-Get/" style="font-size: 0.88rem;">You-Get<sup>1</sup></a><a href="/tags/uniapp/" style="font-size: 0.88rem;">uniapp<sup>1</sup></a><a href="/tags/%E4%B8%8B%E8%BD%BD/" style="font-size: 0.88rem;">下载<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 0.88rem;">前端<sup>9</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 0.88rem;">博客<sup>5</sup></a><a href="/tags/%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 0.88rem;">快捷键<sup>1</sup></a><a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 0.88rem;">爬虫<sup>1</sup></a><a href="/tags/%E7%BB%88%E7%AB%AF/" style="font-size: 0.88rem;">终端<sup>3</sup></a><a href="/tags/%E8%99%9A%E5%B9%BB5/" style="font-size: 0.88rem;">虚幻5<sup>1</sup></a><a href="/tags/%E8%A7%86%E9%A2%91/" style="font-size: 0.88rem;">视频<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="anzhiyufont anzhiyu-icon-comment-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("01/01/2018 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2018 By 安知鱼 V1.6.12",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Ramsayi 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("01/01/2018 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo-h131i132g-ramsayi.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.27/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-h131i132g-ramsayi.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo-h131i132g-ramsayi.vercel.app/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.27/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "visitor@a.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script src="/inject/custom.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="//code.tidio.co/fxk9glqedvgfb9eqhzyajcc3o4oupxbo.js" async="async"></script><script>(() => {
  const isChatBtn = true
  const isChatHideShow = true

  if (isChatBtn) {
    let isShow = false
    const close = () => {
      window.tidioChatApi.hide()
      isShow = false
      document.body.style.position = 'relative';
      document.documentElement.style.overflow = 'auto'
    }
    
    const open = () => {
      window.tidioChatApi.open()
      window.tidioChatApi.show()
      isShow = true
    }

    const onTidioChatApiReady = () => {
      window.tidioChatApi.hide()
      window.tidioChatApi.on("close", close)
    }
    if (window.tidioChatApi) {
      window.tidioChatApi.on("ready", onTidioChatApiReady)
    } else {
      document.addEventListener("tidioChat-ready", onTidioChatApiReady)
    }

    window.chatBtnFn = () => {
      if (!window.tidioChatApi) return
      isShow ? close() : open()
    }
  } else if (isChatHideShow) {
    window.chatBtn = {
      hide: () => {
        window.tidioChatApi && window.tidioChatApi.hide()
      },
      show: () => {
        window.tidioChatApi && window.tidioChatApi.show()
      }
    }
  }
})()</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>